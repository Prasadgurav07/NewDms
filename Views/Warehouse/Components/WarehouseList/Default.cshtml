@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@model List<NewDms.Models.Warehouse>

<div>
    <h5>Warehouse List</h5>
    <div class="list-group">

        <table class="table" id="wl">
            <thead class="bg-dark text-light">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Warehouse name</th>
                    <th scope="col">Location</th>
                    <th scope="col">Capacity</th>
                    <th scope="col">Actions</th>
                </tr>
            </thead>
            <tbody>
        @foreach (var item in Model)
        {
            
                    <tr>
                        <th scope="row">1</th>
                        <td>@item.warehouse_name+Mark</td>
                        <td>@item.warehouse_name+Otto</td>
                        <td> @item.warehouse_name</td>
                        <td>
                            <img src="~/icons/eye.svg" style="width:25px;height:25px;"/>
                        </td>
                    </tr>



                }
            </tbody>
            </table>

       
    </div>
</div>

<script>



    function enableTableFilter(tableId) {
      const table = document.getElementById(tableId);
    if (!table) {
        console.error("Table not found:", tableId);
    return;
      }

    const thead = table.querySelector("thead");
    const tbody = table.querySelector("tbody");
    if (!thead || !tbody) {
        console.error("Table missing <thead> or <tbody>:", tableId);
    return;
      }

    const headerRow = thead.querySelector("tr");
    const colCount = headerRow.children.length;

    // Create a new filter row under headers
    const filterRow = document.createElement("tr");
    filterRow.style.backgroundColor = "#f0f0f0";
    filterRow.style.fontSize="12px";

    for (let i = 0; i < colCount; i++) {
       
        const th = document.createElement("th");
    const select = document.createElement("select");
    select.innerHTML = '<option value="">All</option>';

    // Get unique values for this column
    const uniqueValues = [...new Set(
    Array.from(tbody.rows)
     .map(row => row.cells[i]?.innerText.trim())
    )].sort();

        uniqueValues.forEach(val => {
          const opt = document.createElement("option");
    opt.value = val;
    opt.textContent = val;
    select.appendChild(opt);
        });

        // Add event listener for filtering
           select.addEventListener("change", () => {
        // 1. Get selected value for each column
        const filters = Array.from(filterRow.querySelectorAll("select")).map(s => s.value);

        // 2. Loop over all table rows
        Array.from(tbody.rows).forEach(row => {
        let visible = true;

            filters.forEach((val, index) => {
                // Only check if a filter is selected
                if (val) {
                    const cellText = row.cells[index]?.innerText.trim(); // safe access
    if (cellText !== val) visible = false;
                }
            });

    // 3. Show or hide row
    row.style.display = visible ? "" : "none";
        });
    });

    th.appendChild(select);
    filterRow.appendChild(th);

     if(i==0 || i==colCount-1)
        {
            select.style.visibility="hidden";
            continue;
        }
      }

    // Insert filter row below the header

    thead.appendChild(filterRow);
    }

</script>
